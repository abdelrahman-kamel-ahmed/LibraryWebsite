<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Manage Books - Online Library</title>
  <link rel="stylesheet" href="Css/ManagBooks.css" />
  <!-- Add Font Awesome for the three dots icon -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" />
  <!-- the JS link -->
 <!--<script src="java/ManageBooks.js" defer></script> -->

</head>
<body>

  
  <header class="header">
    <div class="main-header">
      <div class="logo">
        <img src="photos/freebook.webp" alt="" class="logoimg" />
      </div>
      <div class="navbar">
        <a href="index.html">Home</a>
        <a href="about.html">About</a>
        <a href="AdminPage.html">Admin Page</a>
      </div>

      <div class="search-container">
        <form action="#" method="get" class="search-form">
            <div class="search-input-group">
                <input type="text" name="search" placeholder="Search by title, author, or category..." class="search-input">
                <button type="submit" class="search-btn">
                    <i class='bx bx-search'></i>
                </button>
            </div>
            <div class="search-filters">
                <label><input type="radio" name="search-type" value="title" checked> Title</label>
                <label><input type="radio" name="search-type" value="author"> Author</label>
                <label><input type="radio" name="search-type" value="category"> Category</label>
            </div>
        </form>
    </div>
    <!-- Search End -->

    </div>
    <div class="books" id="books">
      <div class="main-topics">
        <h1>Welcome, <span class="admin-name">Admin</span> 📚</h1>
        <p>You can edit the Details of any Book or delete Books if needed </p>
      </div>
      <!-- نافذة Alert المخصصة -->
<div id="customAlert" class="custom-alert">
  <div class="alert-content">
    <div class="alert-icon">📘</div>
    <p id="alertMessage"></p>
    <button id="alertClose" class="alert-button">okay</button>
  </div>
</div>
      
      <div class="book-content">

        <!-- Start Book Card -->
        <div class="col-5">
          <div class="book-actions">
            <div class="dropdown">
              <button class="dropdown-btn"><i class="fas fa-ellipsis-v"></i></button>
              <div class="dropdown-content">
                <a href="EditBooks.html?id=1">Edit</a>
                <a href="#" class="delete-book" data-id="1">Delete</a>
              </div>
            </div>
          </div>
          <a href="bookdetailed.html?id=1">
            <div class="image">
              <img src="photos/book1.jpg" alt="">
            </div>
            <p class="book_name">The Phoenix and the Carpet</p>
          </a>
        </div>   
        
        <div class="col-5">
          <div class="book-actions">
            <div class="dropdown">
              <button class="dropdown-btn"><i class="fas fa-ellipsis-v"></i></button>
              <div class="dropdown-content">
                <a href="EditBooks.html?id=2">Edit</a>
                <a href="#" class="delete-book" data-id="2">Delete</a>
              </div>
            </div>
          </div>
          <a href="bookdetailed.html?id=2">
            <div class="image">
              <img src="photos/book2cover.jpg" alt="">
            </div>
            <p class="book_name">Beyond the Ocean Door</p>
          </a>
        </div>   
        
        <div class="col-5">
          <div class="book-actions">
            <div class="dropdown">
              <button class="dropdown-btn"><i class="fas fa-ellipsis-v"></i></button>
              <div class="dropdown-content">
                <a href="EditBooks.html?id=3">Edit</a>
                <a href="#" class="delete-book" data-id="3">Delete</a>
              </div>
            </div>
          </div>
          <a href="bookdetailed.html?id=3">
            <div class="image">
              <img src="photos/book3cover.webp" alt="">
            </div>
            <p class="book_name">Alone</p>
          </a>
        </div>      
        
        <div class="col-5">
          <div class="book-actions">
            <div class="dropdown">
              <button class="dropdown-btn"><i class="fas fa-ellipsis-v"></i></button>
              <div class="dropdown-content">
                <a href="EditBooks.html?id=4">Edit</a>
                <a href="#" class="delete-book" data-id="4">Delete</a>
              </div>
            </div>
          </div>
          <a href="bookdetailed.html?id=4">
            <div class="image">
              <img src="photos/book4cover.webp" alt="">
            </div>
            <p class="book_name">A Million to One</p>
          </a>
        </div>   
        
        <div class="col-5">
          <div class="book-actions">
            <div class="dropdown">
              <button class="dropdown-btn"><i class="fas fa-ellipsis-v"></i></button>
              <div class="dropdown-content">
                <a href="EditBooks.html?id=5">Edit</a>
                <a href="#" class="delete-book" data-id="5">Delete</a>
              </div>
            </div>
          </div>
          <a href="bookdetailed.html?id=5">
            <div class="image">
              <img src="photos/book6cover.jpg" alt="">
            </div>
            <p class="book_name">The Killer Poison</p>
          </a>
        </div>
        
        <div class="col-5">
          <div class="book-actions">
            <div class="dropdown">
              <button class="dropdown-btn"><i class="fas fa-ellipsis-v"></i></button>
              <div class="dropdown-content">
                <a href="EditBooks.html?id=6">Edit</a>
                <a href="#" class="delete-book" data-id="6">Delete</a>
              </div>
            </div>
          </div>
          <a href="bookdetailed.html?id=6">
            <div class="image">
              <img src="photos/book7cover.jpg" alt="">
            </div>
            <p class="book_name">Really Good Actually</p>
          </a>
        </div>
        
        <div class="col-5">
          <div class="book-actions">
            <div class="dropdown">
              <button class="dropdown-btn"><i class="fas fa-ellipsis-v"></i></button>
              <div class="dropdown-content">
                <a href="EditBooks.html?id=7">Edit</a>
                <a href="#" class="delete-book" data-id="7">Delete</a>
              </div>
            </div>
          </div>
          <a href="bookdetailed.html?id=7">
            <div class="image">
              <img src="photos/book8cover.webp" alt="">
            </div>
            <p class="book_name">Roman</p>
          </a>
        </div>
        
        <div class="col-5">
          <div class="book-actions">
            <div class="dropdown">
              <button class="dropdown-btn"><i class="fas fa-ellipsis-v"></i></button>
              <div class="dropdown-content">
                <a href="EditBooks.html?id=8">Edit</a>
                <a href="#" class="delete-book" data-id="8">Delete</a>
              </div>
            </div>
          </div>
          <a href="bookdetailed.html?id=8">
            <div class="image">
              <img src="photos/book10cover.jpeg" alt="">
            </div>
            <p class="book_name">Don't Look Back</p>
          </a>

          <br>
        </div>

        <div id="bookList" class="book-list"></div>

        <script>
          
          document.addEventListener('DOMContentLoaded', function() {
          // show it from localStorage
          const bookListContainer = document.getElementById("bookList");
          const books = JSON.parse(localStorage.getItem("books")) || [];

          if (books.length === 0 && bookListContainer) {
            bookListContainer.innerHTML = "<p>No books found.</p>";
          } else {
            books.forEach((book, index) => {
              const bookId = index + 9;
              const bookCard = document.createElement("div");
              bookCard.classList.add("col-5");

  alert(`Book  "${book.name}" Were added with img src "${book.cover || "No cover available"}"`);
              bookCard.innerHTML = `
                <div class="book-actions">
                  <div class="dropdown">
                    <button class="dropdown-btn"><i class="fas fa-ellipsis-v"></i></button>
                    <div class="dropdown-content">
                      <a href="EditBooks.html?id=${bookId}">Edit</a>
                      <a href="#" class="delete-book" data-id="${bookId}">Delete</a>
                    </div>
                  </div>
                </div>
                <a href="bookdetailed.html?id=${bookId}">

                  <div class="image">
                    <img src="photos/${book.cover}"  alt="">
                  </div>
                  <p class="book_name">${book.name}</p>
                </a>
              `;
              
              if (bookListContainer) {
                bookListContainer.parentNode.insertBefore(bookCard, bookListContainer);
              }
            });
            
            if (bookListContainer) {
              bookListContainer.remove();
            }
          }

          document.addEventListener('click', function(e) {
            if (e.target.classList.contains('delete-book')) {
              e.preventDefault();
              const bookId = e.target.getAttribute('data-id');
              deleteBook(bookId);
            }
          });




          /*------------   DELETE FUNCTION   -----------*/
          function deleteBook(bookId) {
            if (confirm('Are you sure you want to delete this book?')) {
              //if it was in the local storage
              if (bookId >= 9) {
                const books = JSON.parse(localStorage.getItem("books")) || [];
                const updatedBooks = books.filter((_, index) => (index + 9) !== parseInt(bookId));
                localStorage.setItem("books", JSON.stringify(updatedBooks));
              }
              // delete the book
              const bookElement = document.querySelector(`.delete-book[data-id="${bookId}"]`).closest('.col-5');
              if (bookElement) {
                bookElement.remove();
              }
            }
          }
          });
        </script>


      </div>
      </div>
  </header>

  

  <!-- Modal -->

  <footer class="site-footer">
    <div class="footer-content">
        <div class="footer-logo">
            <img src="photos/freebook.webp" alt="FreeBook Logo">
            <p>Your Gateway to Knowledge</p>
        </div>
        <div class="footer-info">
            <p>&copy; 2023 FreeBook Library System</p>
            <p>CS214 - Database Project</p>
            <p>Cairo University</p>
        </div>
        <div class="footer-contact">
            <p><i class='bx bx-envelope'></i> contact@freebook.edu</p>
            <p><i class='bx bx-phone'></i> +123 456 7890</p>
        </div>
    </div>
</footer>

</body>
</html>